
## from [https://tighten.com/insights/overview-of-caching-strategies-in-laravel/](https://tighten.com/insights/overview-of-caching-strategies-in-laravel/)

 - Caching là một con dao hai lưỡi trong phát triển các ứng dụng PHP.
 - Một mặt, caching mang mang đến những hiệu quả đáng kể về hiệu suất. Nhưng mặt khác, để đạt được điều này có thể dẫn đến sự phức tạp trong mã cơ sở hoắc  cơ sở hạ tầng. Hơn nữa, có nguy cơ caching cung cấp các dữ liệu đã cũ. 

 Vì vậy cần cân nhắc khi về lợi ích và rủi ro khi dùng caching. Để chọn đúng, bạn cần phải làm rất nhiều thứ và dựa vào khả năng thiết lập và ứng dụng của bạn làm gì? 

# Tổng quan về chiến lược caching 

 Mỗi ứng dụng có hàng tá vấn đề cần giải quyết, vì vậy không có giải pháp nào hoàn hảo cho mọi ứng dụng. Do vậy, cần có hiểu biết chắc chắn về logic doanh nghiệp và công nghệ sử dụng để quyêt định dúng đắn cho mỗi ứng dụng, 


## Dưới đây là một vài nguyên lý khi nghi về triển khai cache. 

1. Tối ưu code
 Cache luôn đi kèm với chi phí cao và rủi ro. Giải pháp tôt nhất là tối ưu ứng dụng của bạn để giảm sử dụng tài nguyên và hạn chế phụ thuộc vào casche. 

2. Chọn các lớp caching 

Bạn có thể chọn một cái mà dễ triển khai và kiểm tra. sau  đó triển khai và bổ sung thêm khi cần thiết. 
 Dươi đây là danh sách các tầng caching có săn trong các ứng dụng Laravel. 

| Types                        | Description                                                                                                                                                                                                                                                                                                                                                                                                                         | use case                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | Disadvantage                                                                                                                                                                                                                                                                                                                                         |
|------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| DNS and Webhost HTML caching | - là những thứ xảy ra trước ứng dụng Laravel. thông thưởng , các yều cầu đầy đủ được cache dựa trên các URL yêu cầu và các headers:  <br/> - Bộ đệm này có thể giảm đáng kể chi phí cho việc kết xuất trang, bao gồm bất kỳ các tìm kiêm nào cái mà được yêu cầu để kết xuất ra HTML.                                                                                                                                               | Bộ đệm này hoạt động tốt cho các trang mà không cần các yêu cầu tùy chỉnh dựa trên dữ liêu người dùng hoăc có thể có các tùy chỉnh được thêm vào ( ví dụ thoong qua JS ). Nhiều service có thể quản lý điều này, và chúng có nhiều hành vi đa dạng mà bạn có thể "tap" vào như: Cloudflare Cache, Amazon Cloudfront,Varnish . <br/>Các dịch vụ này vượt trộ trong các trang tĩnh , tương tự như CDNs, và cũng tiết kiệm nhiều tải cho máy chủ vì chúng bắt các yêu cầu đầu vào HTTP và trả về các response và không thực sự gửi request tới máy chủ. | - cache phải được xóa khi nội dung thay đổi. </br>- Không thể được xử lý ở cấp độ mã /app; nó yêu cầu bạn phải tương tác với cấu hình máy chủ/DNS.</br> - Không hỗ trợ routes cần sessions hoặc xử lý gửi form.<br>Bạn có thể cần phải cẩn thận hơn khi tinh chỉnh các tiêu đề HTTP của mình theo cách mà hầu hết các trang web thường không yêu cầu |
| Laravel HTML Caching| - Tương tự như server and DNS, cache toàn bộ HTML, và cho phép bạn tránh các cuộc gọi CSDL và các cuộc gọi tốn nhiều chi phí tới máy chủ trong nhiều trường hợp. </br>- Cho bạn nhiều quyền kiểm soát hơn về cái giì được cache và cái gì không.</br>- Ít cần tương tác với máy chủ nhưng hiệu quả không đáng kể.</br>- Có hai packages cho kiểu này là : Joseph Silber’s Page Cache and Spatie’s ResponseCache.                    | Ví dụ có thể chọn để cache các routes dựa trên session và dữ liệu request. Có thể cache các trang HTML được tủy chỉnh dựa trên từng user hoặc tửng route hoặc từng tham số GET được cung cấp                                                                                                                                                                                                                                                                                                                                                      | -Tất cả các yêu cầu sẽ đến các máy chủ ứng dụng, trừ khi bạn sử dụng bộ đệm Nginx tùy chỉnh trong plugin bộ đệm trang của Joseph Silber. </br>-Hầu hết loại công cụ bộ nhớ đệm này sẽ không cho phép bạn sử dụng dữ liệu phiên trong các trang </br>-Bạn cần đảm bảo xóa bộ đệm HTML tĩnh bất cứ khi nào nội dung của các trang đó cập nhật          |
 |Laravel’s Built-in Caching| Có một số cơ chế bộ đệm của Laravel thực sự hiệu quả và thân thiện với session mà khôn tăng sự phức tạp của mã.                                                                                                                                                                                                                                                                                                                     | - Environment Configuration Caching</br> -  Route Caching </br>- View Caching                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|Laravel Cache| Cung cấp khả năng truy cập tới nhiều dịch vụ cache với 1 API nhất quán. Tầng cache này cho phép bạn cache hầu hết các gía trị, được lưu ở vị trí được định nghĩa bằng cặp chuỗi key-value. Laravel's cache cũng đưa ra nhiều phương thức thuận tiện cho việc ghi, xóa , khóa và điều tiết cache.                                                                                                                                    | -Bạn có thể cache 1 gía trị cần nhiều chi phí để tính toán và bạn biết chính xác khi cần cần xóa "Các giá trị cache đã bị xóa và ứng dụng biết cần tính toán lại "                                                                                                                                                                                                                                                                                                                                                                                | Thường có phạm vi rất hẹp về cái gì sẽ được cached - </br> yêu cầu hiểu biết chắc về logic bussiness khi thiết lập và xóa cache|                                                                                                                                                                                                                      |                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                           |
 |Memoization| -  Là 1 bộ đệm chỉ diễn ra trong 1 yêu cầu. các gía trị được cache hoặc ở mức độ class hoặc ở mức độ request, nhưng không được lưu trên máy chủ, chnsg chỉ được giữ trong bộ nhớ cho request hiện tại sau đó sẽ bị xóa. Bởi vậy chúng nhanh để thiết lập cho hoạt động và ít tiềm ản rui ro do không thể dùng cho các yêu cầu khác.            <br/>  - Memoization in a PHP class </br>     - Memoization in the whole application | Sử dụng cho request hiện tại                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |- Chỉ hoạt động trong request hiện tai cho đối tượng hiện tại.</br> - Khi 1 thay đổi ảnh hương tới giá trị của đầu ra đã được tính toán xảy ra, đối tượng cần khởi tạo lại hoặc hủy giá trị đó.|
 |Database Query Caching| Các truy vấn tới cơ sở dữ liệu thường là nguyên nhân lớn nhất khi nói đến thời gian tải trang trong các ứng dụng web. <br/>-Cơ chế bộ nhớ đệm phía cơ sở dữ liệu này có thể tồn tại trong giao diện phần mềm cơ sở dữ liệu (tức là ở phía trước mặt tiền DB và Model) hoặc ở phía trước cơ sở dữ liệu.                                                                                                                                                                                                                                                                                                        |Mẫu phổ biến nhất để lưu các truy vấn cơ sở dữ liệu vào bộ đệm là sử dụng bộ đệm của Laravel, để gói các lệnh gọi mô hình hoặc DB đắt tiền và lưu vào bộ nhớ đệm các kết quả.||

## 3. Nhớ xóa bộ đệm. 


 Luôn nhớ bất kỳ các giá trị nào được cache đều cân được xóa khi cac yêu tố tác động tới giá trị của nó thay đổi làm cho trở nên lỗi thời. 
 Hoặc thiết lập thời gian hết hạn hợp lý. 



